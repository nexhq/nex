<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="View package details">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Fira+Code&display=swap"
        rel="stylesheet">
    <title>Package Details | nex</title>
    <link rel="stylesheet" href="/_astro/about.BEQDDjDH.css">
    <style>
        /* Loading & Error States */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            gap: 1rem;
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 3px solid rgba(99, 102, 241, 0.2);
            border-top-color: #6366f1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .error-container {
            text-align: center;
            padding: 4rem 2rem;
        }

        .error-container h1 {
            color: #ef4444;
            margin-bottom: 1rem;
        }

        /* Package Header */
        .pkg-header {
            background: linear-gradient(180deg, rgba(99, 102, 241, 0.1) 0%, transparent 100%);
            padding: 3rem 0 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }

        .pkg-header .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .header-top-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 0.75rem;
        }

        .pkg-name {
            font-size: 2rem;
            font-weight: 700;
            margin: 0;
            color: #fff;
        }

        .version-tag {
            background: rgba(99, 102, 241, 0.2);
            color: #a5b4fc;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-family: 'Fira Code', monospace;
        }

        .license-tag {
            background: rgba(34, 197, 94, 0.15);
            color: #86efac;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
        }

        .runtime-tag {
            background: rgba(251, 191, 36, 0.15);
            color: #fcd34d;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
            text-transform: capitalize;
        }

        .pkg-id {
            font-family: 'Fira Code', monospace;
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .pkg-desc {
            color: #aaa;
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 700px;
        }

        /* Tabs */
        .pkg-tabs {
            display: flex;
            gap: 0.5rem;
            margin-top: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            padding-bottom: 0;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 0.75rem 1.25rem;
            color: #888;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
            transition: all 0.2s;
        }

        .tab-btn:hover {
            color: #fff;
        }

        .tab-btn.active {
            color: #a5b4fc;
            border-bottom-color: #6366f1;
        }

        /* Main Layout */
        .pkg-layout {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 2rem;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        @media (max-width: 900px) {
            .pkg-layout {
                grid-template-columns: 1fr;
            }
        }

        /* Main Content */
        .main-content {
            min-width: 0;
        }

        .content-section {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .content-section h2 {
            font-size: 1.25rem;
            margin: 0 0 1rem 0;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Quick Start Card */
        .quick-start {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(139, 92, 246, 0.1) 100%);
            border-color: rgba(99, 102, 241, 0.3);
        }

        .qs-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .qs-left h3 {
            margin: 0 0 0.25rem 0;
            font-size: 1rem;
            color: #fff;
        }

        .qs-left p {
            margin: 0;
            color: #a5b4fc;
            font-size: 0.85rem;
        }

        .qs-cmd {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-family: 'Fira Code', monospace;
        }

        .qs-prompt {
            color: #10b981;
        }

        .qs-cmd code {
            color: #fff;
            font-size: 0.9rem;
        }

        .copy-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            color: #a5b4fc;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .copy-btn svg {
            width: 18px;
            height: 18px;
        }

        /* Commands Table */
        .commands-table {
            overflow-x: auto;
        }

        .commands-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .commands-table th,
        .commands-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }

        .commands-table th {
            color: #888;
            font-weight: 500;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .commands-table code {
            background: rgba(0, 0, 0, 0.3);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        /* Keywords */
        .keywords-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .keyword-tag {
            background: rgba(99, 102, 241, 0.1);
            color: #a5b4fc;
            padding: 0.35rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .sidebar-block {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            padding: 1.25rem;
        }

        .sidebar-block h3 {
            font-size: 0.9rem;
            color: #888;
            margin: 0 0 1rem 0;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Install Command */
        .install-box {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.75rem;
            border-radius: 8px;
            font-family: 'Fira Code', monospace;
            font-size: 0.85rem;
        }

        .install-box code {
            flex: 1;
            color: #fff;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Resource Links */
        .resource-links {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .resource-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0.75rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            color: #ccc;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .resource-link:hover {
            background: rgba(255, 255, 255, 0.08);
            color: #fff;
        }

        .resource-link svg {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        /* Details Info */
        .info-grid {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            color: #888;
            font-size: 0.85rem;
        }

        .info-value {
            color: #fff;
            font-size: 0.9rem;
            font-family: 'Fira Code', monospace;
        }

        .info-value a {
            color: #a5b4fc;
            text-decoration: none;
        }

        .info-value a:hover {
            text-decoration: underline;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Versions List */
        .versions-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .version-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 8px;
        }

        .version-label {
            font-family: 'Fira Code', monospace;
            color: #a5b4fc;
            font-weight: 600;
        }

        .version-date {
            color: #666;
            font-size: 0.85rem;
        }

        .empty-text {
            color: #666;
            text-align: center;
            padding: 2rem;
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="header-top">
            <div class="container header-container">
                <a href="/" class="logo">
                    <span class="logo-text">nex</span>
                </a>
                <div class="search-container">
                    <form action="/packages" method="get" class="search-form">
                        <input type="search" name="q" placeholder="Search packages..." class="search-input"
                            autocomplete="off">
                        <button type="submit" class="search-btn">Search</button>
                    </form>
                </div>
                <nav class="nav-links">
                    <a href="/packages">Packages</a>
                    <a href="/docs">Documentation</a>
                    <a href="https://github.com/nexhq/nex" target="_blank" class="github-link">
                        <svg viewBox="0 0 16 16" width="20" height="20" fill="currentColor">
                            <path
                                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                            </path>
                        </svg>
                    </a>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <!-- Loading State -->
        <div id="loading-state" class="container loading-container">
            <div class="spinner"></div>
            <p>Loading package details...</p>
        </div>

        <!-- Error State -->
        <div id="error-state" class="container error-container" style="display: none;">
            <h1>Package Not Found</h1>
            <p>The package you are looking for does not exist or could not be loaded.</p>
            <a href="/packages" class="btn btn-primary">Browse Packages</a>
        </div>

        <!-- Package Content -->
        <div id="package-content" style="display: none;">
            <!-- Header -->
            <div class="pkg-header">
                <div class="container">
                    <p class="pkg-id" id="pkg-id">author.package</p>
                    <div class="header-top-row">
                        <h1 class="pkg-name" id="pkg-name">Package Name</h1>
                        <span class="version-tag" id="pkg-version">v0.0.0</span>
                        <span class="license-tag" id="pkg-license" style="display: none;">MIT</span>
                        <span class="runtime-tag" id="pkg-runtime" style="display: none;">python</span>
                    </div>
                    <p class="pkg-desc" id="pkg-desc">Package description goes here...</p>

                    <div class="pkg-tabs">
                        <button class="tab-btn active" data-tab="overview">Overview</button>
                        <button class="tab-btn" data-tab="versions">Versions</button>
                        <button class="tab-btn" data-tab="dependencies">Dependencies</button>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="pkg-layout">
                <div class="main-content">
                    <!-- Overview Tab -->
                    <div id="tab-overview" class="tab-content active">
                        <!-- Quick Start -->
                        <div class="content-section quick-start">
                            <div class="qs-row">
                                <div class="qs-left">
                                    <h3>‚ö° Quick Start</h3>
                                    <p>Run instantly with nex</p>
                                </div>
                                <div class="qs-cmd">
                                    <span class="qs-prompt">$</span>
                                    <code id="run-cmd">nex run package</code>
                                    <button class="copy-btn" id="copy-run-btn" title="Copy command">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2"></rect>
                                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Commands -->
                        <div class="content-section" id="commands-section" style="display: none;">
                            <h2>üìã Available Commands</h2>
                            <div class="commands-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Command</th>
                                            <th>Runs</th>
                                        </tr>
                                    </thead>
                                    <tbody id="commands-body"></tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Keywords -->
                        <div class="content-section" id="keywords-section" style="display: none;">
                            <h2>üè∑Ô∏è Keywords</h2>
                            <div class="keywords-list" id="keywords-list"></div>
                        </div>
                    </div>

                    <!-- Versions Tab -->
                    <div id="tab-versions" class="tab-content">
                        <div class="content-section">
                            <h2>üì¶ Version History</h2>
                            <div class="versions-list" id="versions-list"></div>
                            <p class="empty-text" id="no-versions" style="display: none;">No version history available.
                            </p>
                        </div>
                    </div>

                    <!-- Dependencies Tab -->
                    <div id="tab-dependencies" class="tab-content">
                        <div class="content-section">
                            <h2>üîó Dependencies</h2>
                            <div class="versions-list" id="deps-list"></div>
                            <p class="empty-text" id="no-deps" style="display: none;">This package has no dependencies.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Sidebar -->
                <aside class="sidebar">
                    <!-- Install -->
                    <div class="sidebar-block">
                        <h3>Install</h3>
                        <div class="install-box">
                            <code id="install-cmd">nex install package</code>
                            <button class="copy-btn" id="copy-install-btn" title="Copy command">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="9" y="9" width="13" height="13" rx="2"></rect>
                                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Resources -->
                    <div class="sidebar-block" id="resources-block">
                        <h3>Resources</h3>
                        <div class="resource-links" id="resource-links"></div>
                    </div>

                    <!-- Details -->
                    <div class="sidebar-block">
                        <h3>Details</h3>
                        <div class="info-grid" id="info-grid"></div>
                    </div>
                </aside>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <span class="footer-logo">‚ö° nex</span>
                    <p>Nimble Executor</p>
                    <p class="footer-tagline">Package manager for developer tools</p>
                </div>
                <div class="footer-col">
                    <h4>Resources</h4>
                    <a href="/docs">Documentation</a>
                    <a href="/packages">Browse Packages</a>
                    <a href="https://github.com/nexhq/nex/releases">Releases</a>
                </div>
                <div class="footer-col">
                    <h4>Community</h4>
                    <a href="https://github.com/nexhq/nex">GitHub</a>
                    <a href="https://github.com/nexhq/nex/issues">Report Issues</a>
                    <a href="https://github.com/nexhq/nex/blob/main/CONTRIBUTING.md">Contributing</a>
                </div>
                <div class="footer-col">
                    <h4>Legal</h4>
                    <a href="https://github.com/nexhq/nex/blob/main/LICENSE">MIT License</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Nex Contributors</p>
            </div>
        </div>
    </footer>

    <script>
        const API_BASE = 'https://nex-9ujp.onrender.com';

        // Get package ID from URL
        function getPackageId() {
            const pathParts = window.location.pathname.split('/');
            let id = pathParts.pop() || pathParts.pop();

            // Handle edge cases
            if (id === 'index.html') id = pathParts.pop();
            if (id === 'view') id = new URLSearchParams(window.location.search).get('id');
            if (!id || id === 'packages') id = new URLSearchParams(window.location.search).get('id');

            return id;
        }

        // DOM Elements
        const loadingState = document.getElementById('loading-state');
        const errorState = document.getElementById('error-state');
        const packageContent = document.getElementById('package-content');

        // Load package data
        async function loadPackage() {
            const packageId = getPackageId();

            if (!packageId) {
                showError();
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/packages/${packageId}`);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const pkg = await response.json();
                renderPackage(pkg);
            } catch (err) {
                console.error('Failed to load package:', err);
                showError();
            }
        }

        function showError() {
            loadingState.style.display = 'none';
            errorState.style.display = 'block';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text || '';
            return div.innerHTML;
        }

        function renderPackage(pkg) {
            loadingState.style.display = 'none';
            packageContent.style.display = 'block';

            // Update page title
            document.title = `${pkg.name} | nex`;

            // Header info
            document.getElementById('pkg-id').textContent = pkg.id;
            document.getElementById('pkg-name').textContent = pkg.name;
            document.getElementById('pkg-version').textContent = `v${pkg.version}`;
            document.getElementById('pkg-desc').textContent = pkg.description || 'No description provided.';

            // License badge
            if (pkg.license) {
                const licenseEl = document.getElementById('pkg-license');
                licenseEl.textContent = pkg.license;
                licenseEl.style.display = 'inline-block';
            }

            // Runtime badge
            if (pkg.runtime && pkg.runtime.type) {
                const runtimeEl = document.getElementById('pkg-runtime');
                runtimeEl.textContent = pkg.runtime.type;
                runtimeEl.style.display = 'inline-block';
            }

            // Commands
            const runCmd = `nex run ${pkg.id}`;
            const installCmd = `nex install ${pkg.id}`;
            document.getElementById('run-cmd').textContent = runCmd;
            document.getElementById('install-cmd').textContent = installCmd;

            // Copy buttons
            document.getElementById('copy-run-btn').onclick = () => copyToClipboard(runCmd, document.getElementById('copy-run-btn'));
            document.getElementById('copy-install-btn').onclick = () => copyToClipboard(installCmd, document.getElementById('copy-install-btn'));

            // Available Commands
            if (pkg.commands && Object.keys(pkg.commands).length > 0) {
                document.getElementById('commands-section').style.display = 'block';
                const commandsBody = document.getElementById('commands-body');
                commandsBody.innerHTML = Object.entries(pkg.commands).map(([name, cmd]) => {
                    const cmdName = name === 'default' ? '' : name;
                    return `
                        <tr>
                            <td><code>nex run ${pkg.id} ${cmdName}</code></td>
                            <td><code>${escapeHtml(cmd)}</code></td>
                        </tr>
                    `;
                }).join('');
            }

            // Keywords
            if (pkg.keywords && pkg.keywords.length > 0) {
                document.getElementById('keywords-section').style.display = 'block';
                document.getElementById('keywords-list').innerHTML = pkg.keywords.map(k =>
                    `<span class="keyword-tag">${escapeHtml(k)}</span>`
                ).join('');
            }

            // Resources
            const resourceLinks = document.getElementById('resource-links');
            resourceLinks.innerHTML = '';

            if (pkg.repository) {
                resourceLinks.innerHTML += `
                    <a href="${escapeHtml(pkg.repository)}" target="_blank" rel="noopener" class="resource-link">
                        <svg viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                        </svg>
                        Repository
                    </a>
                `;

                if (pkg.repository.includes('github.com')) {
                    resourceLinks.innerHTML += `
                        <a href="${escapeHtml(pkg.repository.replace(/\.git$/, ''))}/issues" target="_blank" rel="noopener" class="resource-link">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="8" x2="12" y2="12"></line>
                                <line x1="12" y1="16" x2="12.01" y2="16"></line>
                            </svg>
                            Issues
                        </a>
                    `;
                }
            }

            if (pkg.homepage) {
                resourceLinks.innerHTML += `
                    <a href="${escapeHtml(pkg.homepage)}" target="_blank" rel="noopener" class="resource-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                        Homepage
                    </a>
                `;
            }

            // Hide resources block if empty
            if (resourceLinks.innerHTML.trim() === '') {
                document.getElementById('resources-block').style.display = 'none';
            }

            // Details grid
            const infoGrid = document.getElementById('info-grid');
            let infoHtml = `
                <div class="info-item">
                    <span class="info-label">Version</span>
                    <span class="info-value">${escapeHtml(pkg.version)}</span>
                </div>
            `;

            if (pkg.author) {
                const authorName = typeof pkg.author === 'string' ? pkg.author : pkg.author.name;
                const authorGithub = typeof pkg.author === 'object' ? pkg.author.github : null;
                infoHtml += `
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">
                            ${authorGithub
                        ? `<a href="https://github.com/${authorGithub}" target="_blank">${escapeHtml(authorName || authorGithub)}</a>`
                        : escapeHtml(authorName || 'Unknown')}
                        </span>
                    </div>
                `;
            }

            if (pkg.license) {
                infoHtml += `
                    <div class="info-item">
                        <span class="info-label">License</span>
                        <span class="info-value">${escapeHtml(pkg.license)}</span>
                    </div>
                `;
            }

            if (pkg.runtime) {
                infoHtml += `
                    <div class="info-item">
                        <span class="info-label">Runtime</span>
                        <span class="info-value">${escapeHtml(pkg.runtime.type || '')} ${escapeHtml(pkg.runtime.version || '')}</span>
                    </div>
                `;
            }

            if (pkg.entrypoint) {
                infoHtml += `
                    <div class="info-item">
                        <span class="info-label">Entrypoint</span>
                        <span class="info-value">${escapeHtml(pkg.entrypoint)}</span>
                    </div>
                `;
            }

            infoGrid.innerHTML = infoHtml;

            // Versions tab
            const versionsList = document.getElementById('versions-list');
            const versions = pkg.versions || [{ version: pkg.version, date: pkg.createdAt || pkg.updatedAt }];

            if (versions.length === 0) {
                document.getElementById('no-versions').style.display = 'block';
            } else {
                versionsList.innerHTML = versions.map(v => `
                    <div class="version-item">
                        <div>
                            <div class="version-label">v${escapeHtml(v.version)}</div>
                            ${v.date ? `<div class="version-date">${new Date(v.date).toLocaleDateString()}</div>` : ''}
                        </div>
                        <button class="copy-btn" onclick="copyToClipboard('nex install ${pkg.id}@${v.version}', this)" title="Copy install command">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="9" y="9" width="13" height="13" rx="2"></rect>
                                <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                            </svg>
                        </button>
                    </div>
                `).join('');
            }

            // Dependencies tab
            const depsList = document.getElementById('deps-list');
            let deps = [];
            if (Array.isArray(pkg.dependencies)) {
                deps = pkg.dependencies;
            } else if (pkg.dependencies && typeof pkg.dependencies === 'object') {
                deps = Object.entries(pkg.dependencies).map(([id, version]) => ({ id, version }));
            }

            if (deps.length === 0) {
                document.getElementById('no-deps').style.display = 'block';
            } else {
                depsList.innerHTML = deps.map(d => `
                    <div class="version-item">
                        <div>
                            <div class="version-label">${escapeHtml(d.id || d.name)}</div>
                        </div>
                        ${d.version ? `<span class="version-date">${escapeHtml(d.version)}</span>` : ''}
                    </div>
                `).join('');
            }
        }

        // Copy to clipboard
        async function copyToClipboard(text, btn) {
            try {
                await navigator.clipboard.writeText(text);
                const originalHtml = btn.innerHTML;
                btn.innerHTML = `
                    <svg viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                `;
                setTimeout(() => {
                    btn.innerHTML = originalHtml;
                }, 2000);
            } catch (err) {
                console.error('Copy failed:', err);
            }
        }

        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tabId = btn.dataset.tab;

                // Update active tab button
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                // Show corresponding content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(`tab-${tabId}`).classList.add('active');
            });
        });

        // Initialize
        loadPackage();
    </script>
</body>

</html>