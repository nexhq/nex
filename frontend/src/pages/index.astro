---
import Layout from '../layouts/Layout.astro';

// Fetch packages from registry (at build time)
const registryUrl = 'https://raw.githubusercontent.com/devkiraa/nex/main/registry/index.json';
let packages = [];
let error = null;

try {
  if (import.meta.env.DEV) {
    packages = [
      {
        id: 'devkiraa.pagepull',
        name: 'PagePull',
        version: '1.0.0',
        description: 'Extract web pages as clean Markdown for AI/LLM consumption',
        keywords: ['web', 'scraper', 'markdown', 'ai', 'llm']
      }
    ];
  } else {
    const response = await fetch(registryUrl);
    const data = await response.json();
    packages = data.packages || [];
  }
} catch (e) {
  error = e.message;
  packages = [];
}

const baseUrl = import.meta.env.BASE_URL;
const releaseVersion = 'v1.0.0';
const releaseBaseUrl = `https://github.com/devkiraa/nex/releases/download/${releaseVersion}`;
const releasePageUrl = `https://github.com/devkiraa/nex/releases/tag/${releaseVersion}`;
const downloadLinks = {
  windows: `${releaseBaseUrl}/nex-windows-x64.exe`,
  linux: `${releaseBaseUrl}/nex-linux-x64`,
  mac: `${releaseBaseUrl}/nex-macos-x64`,
};
---

<Layout title="Home" showSearch={false}>
  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-bg"></div>
    <div class="container hero-content">
      <div class="hero-text">
        <h1 class="hero-title">
          Build amazing tools.
          <span class="hero-highlight">Share them with the world.</span>
        </h1>
        <p class="hero-subtitle">
          The package manager for developer tools. Install, run, and share utilities with a single command.
        </p>
        
        <div class="hero-search">
          <form action={`${baseUrl}packages`} method="get" class="hero-search-form">
            <svg class="search-icon" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <input 
              type="search" 
              name="q" 
              id="search-input"
              placeholder="Search packages..." 
              class="hero-search-input"
              autocomplete="off"
            />
            <button type="submit" class="hero-search-btn">Search</button>
            <div id="search-results" class="search-results"></div>
          </form>
          <div id="packages-data" data-packages={JSON.stringify(packages)} data-baseurl={baseUrl} style="display:none;"></div>
        </div>
        
        <div class="hero-stats">
          <div class="stat">
            <span class="stat-value">{packages.length}</span>
            <span class="stat-label">Packages</span>
          </div>
          <div class="stat">
            <span class="stat-value">3</span>
            <span class="stat-label">Platforms</span>
          </div>
          <div class="stat">
            <span class="stat-value">âˆž</span>
            <span class="stat-label">Possibilities</span>
          </div>
        </div>
      </div>
      
      <div class="hero-visual">
        <div class="hero-logo">nex</div>
      </div>
    </div>
  </section>

  <!-- Quick Install Section -->
  <section class="install-section">
    <div class="container">
      <div class="install-box">
        <div class="release-info">
          <div>
            <span class="release-label">Latest release</span>
            <span class="release-version">{releaseVersion}</span>
          </div>
          <a href={releasePageUrl} target="_blank" rel="noopener" class="release-link">
            View release notes
          </a>
        </div>
        <div class="install-tabs">
          <button class="tab active" data-tab="windows">Windows</button>
          <button class="tab" data-tab="linux">Linux</button>
          <button class="tab" data-tab="mac">macOS</button>
        </div>
        <div class="install-content">
          <div class="install-panel active" id="windows">
            <pre><code><span class="comment"># Download nex {releaseVersion}</span>
curl -LO {downloadLinks.windows}

<span class="comment"># Move into a folder on PATH</span>
move .\nex-windows-x64.exe %USERPROFILE%\bin\nex.exe

<span class="comment"># Verify</span>
nex --version</code></pre>
          </div>
          <div class="install-panel" id="linux">
            <pre><code><span class="comment"># Download nex {releaseVersion}</span>
curl -LO {downloadLinks.linux}
sudo install -m 755 nex-linux-x64 /usr/local/bin/nex

<span class="comment"># Verify</span>
nex --version</code></pre>
          </div>
          <div class="install-panel" id="mac">
            <pre><code><span class="comment"># Download nex {releaseVersion}</span>
curl -LO {downloadLinks.mac}
sudo install -m 755 nex-macos-x64 /usr/local/bin/nex

<span class="comment"># Verify</span>
nex --version</code></pre>
          </div>
        </div>
        <div class="install-cta">
          <a href={releasePageUrl} class="btn btn-primary" target="_blank" rel="noopener">
            Download nex {releaseVersion}
          </a>
          <a href={`${baseUrl}docs`} class="btn btn-secondary">
            Read the Docs
          </a>
        </div>
        <p class="checksum-note">Checksums and binaries are hosted on GitHub Releases. Always verify downloads before installing.</p>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section class="features">
    <div class="container">
      <h2 class="section-title">Why nex?</h2>
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">ðŸš€</div>
          <h3>Zero Dependencies</h3>
          <p>Single executable binary. No runtime required. Works on Windows, Linux, and macOS.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ðŸ“¦</div>
          <h3>GitHub-Powered</h3>
          <p>Package registry lives on GitHub. Fork, submit PRs, and collaborate openly.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ðŸ”§</div>
          <h3>Multi-Runtime</h3>
          <p>Run Python, Node.js, PowerShell, Bash scripts and native binaries seamlessly.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">âš¡</div>
          <h3>Lightning Fast</h3>
          <p>Written in C for maximum performance. Instant installs and execution.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ðŸ”’</div>
          <h3>Secure</h3>
          <p>Packages are reviewed via pull requests. SHA256 checksums for downloads.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ðŸ’š</div>
          <h3>Open Source</h3>
          <p>MIT licensed. Community-driven. Free forever.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Packages Section -->
  <section class="packages-section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Discover Packages</h2>
        <a href={`${baseUrl}packages`} class="view-all">View all packages â†’</a>
      </div>
      
      {error && <p class="error-msg">Failed to load packages: {error}</p>}
      
      <div class="packages-grid">
        {packages.slice(0, 6).map((pkg) => (
          <a href={`${baseUrl}packages/${pkg.id}`} class="package-card">
            <div class="package-content">
              <div class="package-header">
                <div class="package-title-row">
                  <h3 class="package-name">{pkg.name}</h3>
                  <span class="package-version">v{pkg.version}</span>
                </div>
                <p class="package-id">{pkg.id}</p>
              </div>
              <p class="package-desc">{pkg.description}</p>
            </div>
            <div class="package-footer">
              <div class="package-tags">
                {pkg.keywords && pkg.keywords.slice(0, 3).map((kw: string) => (
                  <span class="tag">{kw}</span>
                ))}
              </div>
              <div class="package-action">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                  <polyline points="12 5 19 12 12 19"></polyline>
                </svg>
              </div>
            </div>
          </a>
        ))}
      </div>
      
      {packages.length === 0 && !error && (
        <div class="empty-state">
          <p>No packages available yet. Be the first to <a href="https://github.com/devkiraa/nex">contribute</a>!</p>
        </div>
      )}
    </div>
  </section>

  <!-- CTA Section -->
  <section class="cta-section">
    <div class="container">
      <div class="cta-content">
        <h2>Ready to share your tools?</h2>
        <p>Publishing a package is simple. Create a manifest, submit a PR, and you're live.</p>
        <div class="cta-buttons">
          <a href={`${baseUrl}docs`} class="btn btn-primary">Get Started</a>
          <a href="https://github.com/devkiraa/nex" class="btn btn-dark">
            <svg viewBox="0 0 16 16" width="18" height="18" fill="currentColor" style="margin-right: 8px">
              <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
            Star on GitHub
          </a>
        </div>
      </div>
    </div>
  </section>
</Layout>

<style>
  /* Hero Section */
  .hero {
    position: relative;
    min-height: calc(100vh - 70px);
    display: flex;
    align-items: center;
    padding: 2rem 0;
    background: var(--nex-bg);
    color: var(--nex-black);
    overflow: hidden;
    border-bottom: 1px solid var(--nex-border);
  }
  
  .hero-bg {
    display: none;
  }
  
  .hero-content {
    position: relative;
    display: grid;
    grid-template-columns: 1.2fr 0.8fr;
    gap: 4rem;
    align-items: center;
  }

  .hero-text {
    text-align: left;
  }

  .hero-visual {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .hero-logo {
    font-size: 12rem;
    font-weight: 800;
    letter-spacing: -8px;
    margin-bottom: 0;
    color: var(--nex-red);
    line-height: 1;
  }

  .hero-title {
    font-size: 3.5rem;
    font-weight: 700;
    line-height: 1.1;
    margin-bottom: 1.5rem;
    color: var(--nex-black);
  }
  
  .hero-highlight {
    display: block;
    color: var(--nex-red);
  }
  
  .hero-subtitle {
    font-size: 1.25rem;
    color: var(--nex-gray);
    max-width: 600px;
    margin: 0 0 2.5rem;
  }
  
  .hero-search {
    max-width: 100%;
    margin: 0 0 3rem;
  }
  
  .hero-search-form {
    display: flex;
    background: white;
    border-radius: 12px;
    padding: 0.5rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    border: 1px solid var(--nex-border);
    max-width: 500px;
    position: relative;
  }
  
  .search-icon {
    position: absolute;
    left: 1.25rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--nex-gray);
    pointer-events: none;
  }
  
  .hero-search-input {
    flex: 1;
    padding: 1rem 1rem 1rem 3rem;
    border: none;
    font-size: 1.1rem;
    font-family: inherit;
    background: transparent;
    outline: none;
    color: var(--nex-black);
  }
  
  .hero-search-input::placeholder {
    color: var(--nex-gray);
  }
  
  .hero-search-btn {
    padding: 1rem 2rem;
    background: var(--nex-black);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  
  .hero-search-btn:hover {
    background: #000;
  }

  .search-results {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    border: 1px solid var(--nex-border);
    margin-top: 0.5rem;
    max-height: 300px;
    overflow-y: auto;
    z-index: 100;
    display: none;
    text-align: left;
  }
  
  .search-results.active {
    display: block;
  }

  .search-result-item {
    display: block;
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--nex-border);
    color: var(--nex-black);
    text-decoration: none;
    transition: background 0.1s;
  }

  .search-result-item:last-child {
    border-bottom: none;
  }

  .search-result-item:hover {
    background: var(--nex-bg);
  }

  .search-result-name {
    font-weight: 600;
    display: block;
    font-size: 0.95rem;
  }
  
  .search-result-desc {
    font-size: 0.8rem;
    color: var(--nex-gray);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    display: block;
  }
  
  .hero-stats {
    display: flex;
    justify-content: center;
    gap: 4rem;
  }
  
  .stat {
    text-align: center;
  }
  
  .stat-value {
    display: block;
    font-size: 2rem;
    font-weight: 700;
  }
  
  .stat-label {
    font-size: 0.9rem;
    opacity: 0.8;
  }

  /* Install Section */
  .install-section {
    position: relative;
    z-index: 10;
    padding: 4rem 0;
    background: white;
    min-height: 100vh;
    display: flex;
    align-items: center;
  }
  
  .install-box {
    background: white;
    border-radius: 16px;
    box-shadow: var(--shadow-lg);
    overflow: hidden;
  }

  .release-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.25rem 1.5rem 0.5rem;
    gap: 1rem;
  }

  .release-label {
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--nex-gray);
    display: block;
  }

  .release-version {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--nex-red);
  }

  .release-link {
    font-weight: 500;
    color: var(--nex-red);
  }
  
  .install-tabs {
    display: flex;
    border-bottom: 1px solid var(--nex-border);
  }
  
  .tab {
    flex: 1;
    padding: 1rem;
    background: none;
    border: none;
    font-size: 1rem;
    font-weight: 500;
    color: var(--nex-gray);
    cursor: pointer;
    transition: all 0.2s;
    border-bottom: 3px solid transparent;
    margin-bottom: -1px;
  }
  
  .tab:hover {
    color: var(--nex-dark);
  }
  
  .tab.active {
    color: var(--nex-red);
    border-bottom-color: var(--nex-red);
  }
  
  .install-content {
    padding: 0;
  }
  
  .install-panel {
    display: none;
  }
  
  .install-panel.active {
    display: block;
  }
  
  .install-panel pre {
    margin: 0;
    border-radius: 0;
    font-size: 0.95rem;
    line-height: 1.7;
    background: #1e1e1e;
    color: #ffffff;
    padding: 1.5rem;
  }
  
  .install-panel .comment {
    color: #6a9955;
  }
  
  .install-cta {
    display: flex;
    gap: 1rem;
    padding: 1.5rem;
    background: var(--nex-bg);
    justify-content: center;
  }

  .checksum-note {
    text-align: center;
    font-size: 0.85rem;
    color: var(--nex-gray);
    padding: 0 1.5rem 1.5rem;
  }

  /* Features Section */
  .features {
    padding: 5rem 0;
    min-height: 100vh;
    display: flex;
    align-items: center;
  }
  
  .section-title {
    font-size: 2rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: 3rem;
    color: var(--nex-black);
  }
  
  .features-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
  }
  
  .feature-card {
    background: white;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: var(--shadow-sm);
    transition: all 0.2s;
  }
  
  .feature-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-md);
  }
  
  .feature-icon {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }
  
  .feature-card h3 {
    font-size: 1.25rem;
    margin-bottom: 0.5rem;
    color: var(--nex-black);
  }
  
  .feature-card p {
    color: var(--nex-gray);
    font-size: 0.95rem;
  }

  /* Packages Section */
  .packages-section {
    padding: 4rem 0;
    background: white;
    min-height: 100vh;
    display: flex;
    align-items: center;
  }
  
  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
  }
  
  .section-header .section-title {
    margin-bottom: 0;
    text-align: left;
  }
  
  .view-all {
    font-weight: 500;
    color: var(--nex-red);
  }
  
  .packages-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
  }
  
  .package-card {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    background: white;
    border: 1px solid var(--nex-border);
    border-radius: 16px;
    padding: 1.75rem;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    text-decoration: none;
    height: 100%;
    position: relative;
    overflow: hidden;
  }
  
  .package-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, var(--nex-red), var(--nex-red-light));
    opacity: 0;
    transition: opacity 0.3s;
  }

  .package-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.08);
    border-color: transparent;
    text-decoration: none;
  }
  
  .package-card:hover::before {
    opacity: 1;
  }

  .package-content {
    margin-bottom: 1.5rem;
  }

  .package-title-row {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 0.25rem;
  }

  .package-name {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--nex-black);
  }

  .package-version {
    font-size: 0.8rem;
    background: var(--nex-bg);
    padding: 0.1rem 0.5rem;
    border-radius: 4px;
    color: var(--nex-dark);
    font-family: var(--font-mono);
    font-weight: 500;
  }

  .package-id {
    font-size: 0.85rem;
    color: var(--nex-gray);
    font-family: var(--font-mono);
    margin-bottom: 1rem;
  }

  .package-desc {
    font-size: 0.95rem;
    color: var(--nex-dark);
    line-height: 1.6;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .package-footer {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
  }

  .package-tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .tag {
    background: var(--nex-bg);
    border: 1px solid transparent;
    padding: 0.25rem 0.75rem;
    border-radius: 100px;
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--nex-dark);
    transition: all 0.2s;
  }
  
  .package-card:hover .tag {
    border-color: var(--nex-border);
    background: white;
  }

  .package-action {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: var(--nex-bg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--nex-black);
    transition: all 0.2s;
    opacity: 0;
    transform: translateX(-10px);
  }

  .package-card:hover .package-action {
    opacity: 1;
    transform: translateX(0);
    background: var(--nex-black);
    color: white;
  }
  
  .empty-state {
    text-align: center;
    padding: 4rem 2rem;
    color: var(--nex-gray);
  }
  
  .error-msg {
    background: #ffeaea;
    color: var(--nex-red);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
  }

  /* CTA Section */
  .cta-section {
    padding: 5rem 0;
    background: linear-gradient(135deg, var(--nex-black) 0%, #333 100%);
    color: white;
    min-height: 100vh;
    display: flex;
    align-items: center;
  }
  
  .cta-content {
    text-align: center;
    max-width: 600px;
    margin: 0 auto;
  }
  
  .cta-content h2 {
    font-size: 2rem;
    margin-bottom: 1rem;
  }
  
  .cta-content p {
    opacity: 0.8;
    margin-bottom: 2rem;
  }
  
  .cta-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
  }
  
  .cta-buttons .btn-dark {
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.2);
  }
  
  .cta-buttons .btn-dark:hover {
    background: rgba(255,255,255,0.2);
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .hero-content {
      grid-template-columns: 1fr;
      text-align: center;
      gap: 3rem;
    }

    .hero-text {
      text-align: center;
      margin: 0 auto;
      max-width: 800px;
    }

    .hero-search-form {
      margin: 0 auto;
    }

    .hero-stats {
      justify-content: center;
    }
    
    .hero-visual {
      order: -1;
      margin-bottom: 1rem;
    }
    
    .hero-logo {
      font-size: 10rem;
    }
  }

  @media (max-width: 768px) {
    .features-grid,
    .packages-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .hero-title {
      font-size: 3rem;
    }
    
    .install-section,
    .features,
    .packages-section,
    .cta-section {
      min-height: auto;
      padding: 4rem 0;
    }
  }
  
  @media (max-width: 640px) {
    .hero {
      min-height: auto;
      padding: 3rem 0 2rem;
    }
    
    .hero-logo {
      font-size: 5rem;
      letter-spacing: -4px;
    }

    .hero-title {
      font-size: 2rem;
    }
    
    .hero-subtitle {
      font-size: 1rem;
      margin-bottom: 2rem;
    }
    
    .hero-search {
      margin-bottom: 2rem;
    }
    
    .hero-search-form {
      flex-direction: column;
      gap: 0.5rem;
      padding: 0.75rem;
      max-width: 100%;
    }
    
    .search-icon {
      top: 1.35rem;
      left: 1.5rem;
      width: 20px;
      height: 20px;
    }
    
    .hero-search-input {
      padding: 0.85rem 0.85rem 0.85rem 2.75rem;
      font-size: 1rem;
      width: 100%;
    }
    
    .hero-search-btn {
      padding: 0.85rem 1.5rem;
      width: 100%;
      border-radius: 8px;
    }
    
    .search-results {
      position: fixed;
      top: auto;
      bottom: 0;
      left: 0;
      right: 0;
      margin: 0;
      border-radius: 12px 12px 0 0;
      max-height: 60vh;
    }
    
    .hero-stats {
      flex-direction: row;
      flex-wrap: wrap;
      gap: 1.5rem;
      justify-content: center;
    }
    
    .stat {
      min-width: 70px;
    }
    
    .stat-value {
      font-size: 1.75rem;
    }
    
    .stat-label {
      font-size: 0.8rem;
    }
    
    .features-grid,
    .packages-grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }
    
    .feature-card {
      padding: 1.5rem;
    }
    
    .feature-icon {
      font-size: 2rem;
    }
    
    .feature-card h3 {
      font-size: 1.1rem;
    }
    
    .feature-card p {
      font-size: 0.9rem;
    }
    
    .package-card {
      padding: 1.25rem;
    }
    
    .package-name {
      font-size: 1.1rem;
    }
    
    .package-id {
      font-size: 0.8rem;
      word-break: break-all;
    }
    
    .package-desc {
      font-size: 0.9rem;
      -webkit-line-clamp: 2;
    }
    
    .package-action {
      display: none;
    }
    
    .cta-buttons {
      flex-direction: column;
      width: 100%;
    }
    
    .cta-buttons .btn {
      width: 100%;
      text-align: center;
    }
    
    .cta-content h2 {
      font-size: 1.5rem;
    }
    
    .cta-content p {
      font-size: 0.95rem;
    }
    
    .section-title {
      font-size: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .section-header {
      flex-direction: column;
      gap: 0.75rem;
      text-align: center;
      align-items: stretch;
    }
    
    .view-all {
      text-align: center;
      display: block;
    }
    
    .install-box {
      border-radius: 12px;
      margin: 0 -0.5rem;
    }
    
    .release-info {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
      padding: 1rem;
    }
    
    .release-version {
      font-size: 1.25rem;
    }
    
    .install-tabs {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    .tab {
      padding: 0.75rem 0.5rem;
      font-size: 0.9rem;
      white-space: nowrap;
    }
    
    .install-panel pre {
      padding: 1rem;
      font-size: 0.8rem;
      line-height: 1.6;
    }
    
    .install-cta {
      flex-direction: column;
      padding: 1rem;
    }
    
    .install-cta .btn {
      width: 100%;
      text-align: center;
      padding: 0.85rem 1rem;
    }
    
    .checksum-note {
      font-size: 0.8rem;
      padding: 0 1rem 1rem;
    }
  }
  
  @media (max-width: 400px) {
    .hero-logo {
      font-size: 4rem;
    }
    
    .hero-title {
      font-size: 1.75rem;
    }
    
    .hero-stats {
      gap: 1rem;
    }
    
    .stat {
      min-width: 60px;
    }
    
    .stat-value {
      font-size: 1.5rem;
    }
  }
</style>

<script>
  // Tab switching
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', () => {
      const target = tab.getAttribute('data-tab');
      if (!target) return;
      
      // Update tabs
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      
      // Update panels
      document.querySelectorAll('.install-panel').forEach(p => p.classList.remove('active'));
      document.getElementById(target)?.classList.add('active');
    });
  });

  // Search Autocomplete
  const searchInput = document.getElementById('search-input');
  const searchResults = document.getElementById('search-results');
  const packagesDataElement = document.getElementById('packages-data');
  
  if (searchInput instanceof HTMLInputElement && searchResults && packagesDataElement) {
    const packagesStr = packagesDataElement.dataset.packages || '[]';
    const packages = JSON.parse(packagesStr);
    const baseUrl = packagesDataElement.dataset.baseurl || '/';

    searchInput.addEventListener('input', (e) => {
      const target = e.target;
      if (!target || !(target instanceof HTMLInputElement)) return;
      
      const query = target.value.toLowerCase();
      if (query.length < 1) {
        searchResults.classList.remove('active');
        return;
      }

      const filtered = packages.filter((p) => 
        p.name.toLowerCase().includes(query) || 
        p.id.toLowerCase().includes(query) ||
        (p.description && p.description.toLowerCase().includes(query))
      ).slice(0, 5);

      if (filtered.length > 0) {
        searchResults.innerHTML = filtered.map((p) => `
          <a href="${baseUrl}packages/${p.id}" class="search-result-item">
            <span class="search-result-name">${p.name}</span>
            <span class="search-result-desc">${p.description || ''}</span>
          </a>
        `).join('');
        searchResults.classList.add('active');
      } else {
        searchResults.classList.remove('active');
      }
    });

    // Hide when clicking outside
    document.addEventListener('click', (e) => {
      const target = e.target;
      if (target instanceof Node && !searchInput.contains(target) && !searchResults.contains(target)) {
        searchResults.classList.remove('active');
      }
    });
    
    // Show again if focused and has content
    searchInput.addEventListener('focus', () => {
        if (searchInput.value.length >= 1) {
             searchInput.dispatchEvent(new Event('input'));
        }
    });
  }
</script>
